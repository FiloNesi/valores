<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>¬øQu√© es la filosof√≠a? ¬∑ Web interactiva</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#0b1020; --card:#0f172a; --ink:#e5e7eb; --accent:#22d3ee; --accent-2:#a78bfa; }
    html,body{height:100%}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:linear-gradient(180deg,#0b1020,#0d132a); color:var(--ink)}
    .glass{background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.04)); backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,.08)}
    .ring-a{box-shadow:0 0 0 2px rgba(34,211,238,.35), 0 10px 30px rgba(167,139,250,.15)}
    .kbd{border:1px solid rgba(255,255,255,.25); border-bottom-width:2px; border-radius:.5rem; padding:.15rem .4rem; font-size:.8rem}
    @media print{ .no-print{display:none!important} body{background:white;color:#111827} .glass, .ring-a{box-shadow:none} }
    /* Simple focus ring for keyboard users */
    :focus-visible{outline:3px solid var(--accent); outline-offset:2px}
  </style>
</head>
<body>
  <!-- Header / Navbar -->
  <header class="sticky top-0 z-30 bg-[#0b1020]/80 backdrop-blur border-b border-white/10">
    <nav class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-14" aria-label="Navegaci√≥n principal">
      <a href="#inicio" class="font-extrabold tracking-tight text-xl">Filo<span class="text-cyan-300">Lab</span></a>
      <div class="hidden sm:flex items-center gap-6 text-sm">
        <a href="#leer" class="hover:text-cyan-300">Leer</a>
        <a href="#practicar" class="hover:text-cyan-300">Practicar</a>
        <a href="#generar" class="hover:text-cyan-300">Generar</a>
        <a href="#dialogo" class="hover:text-cyan-300">Di√°logo</a>
      </div>
      <div class="flex items-center gap-2">
        <button id="btnAjustes" class="no-print px-3 py-1.5 rounded-lg glass hover:ring-a transition" aria-haspopup="dialog" aria-controls="modalAjustes">Ajustes</button>
        <button id="btnAyuda" class="no-print px-3 py-1.5 rounded-lg bg-cyan-400/20 text-cyan-200 hover:bg-cyan-400/30 transition" aria-haspopup="dialog" aria-controls="modalAyuda">Ayuda</button>
      </div>
    </nav>
  </header>

  <!-- Hero -->
  <section id="inicio" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <div class="grid md:grid-cols-2 gap-8 items-center">
      <div>
        <h1 class="text-3xl sm:text-4xl md:text-5xl font-extrabold leading-tight">
          ¬øQu√© es la <span class="text-cyan-300">filosof√≠a</span>?
        </h1>
        <p class="mt-4 text-lg text-slate-300">
          Desde la antig√ºedad, los seres humanos nos hemos hecho preguntas sobre nuestra propia existencia: qui√©n somos, por qu√© estamos aqu√≠, qu√© es lo correcto y lo incorrecto, cu√°l es el sentido de la vida‚Ä¶ De la b√∫squeda de respuestas nace la filosof√≠a.
        </p>
        <div class="mt-6 flex gap-3">
          <a href="#leer" class="px-4 py-2 rounded-xl bg-cyan-400 text-slate-900 font-semibold hover:bg-cyan-300 transition">Empezar</a>
          <a href="#practicar" class="px-4 py-2 rounded-xl glass hover:ring-a transition">Ir a practicar</a>
        </div>
        <p class="mt-4 text-sm text-slate-400">Sugerencia: pulsa <span class="kbd">?</span> para ver atajos.</p>
      </div>
      <div class="relative">
        <div class="glass rounded-3xl p-6 ring-a">
          <h2 class="text-xl font-bold mb-3">Idea central</h2>
          <p class="text-slate-300">La filosof√≠a es la <strong>reflexi√≥n</strong> y el <strong>pensamiento cr√≠tico</strong> que hace la inteligencia humana sobre s√≠ misma, sobre sus l√≠mites, sobre sus creaciones, sobre el ser humano y su relaci√≥n con la realidad.</p>
          <div class="mt-4 grid grid-cols-3 gap-3 text-center">
            <div class="glass rounded-xl p-3" title="Universalidad">
              <div class="text-2xl">üåç</div>
              <div class="text-xs text-slate-300 mt-1">Universal</div>
            </div>
            <div class="glass rounded-xl p-3" title="Cr√≠tica y reflexi√≥n">
              <div class="text-2xl">üß†</div>
              <div class="text-xs text-slate-300 mt-1">Cr√≠tica</div>
            </div>
            <div class="glass rounded-xl p-3" title="Di√°logo razonado">
              <div class="text-2xl">üí¨</div>
              <div class="text-xs text-slate-300 mt-1">Di√°logo</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- LEER -->
  <section id="leer" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-10">
    <div class="grid md:grid-cols-2 gap-6 items-start">
      <!-- Definici√≥n -->
      <article class="glass rounded-3xl p-6" aria-labelledby="tit-def">
        <h3 id="tit-def" class="text-2xl font-bold">Definici√≥n breve</h3>
        <p class="mt-3 text-slate-300">
          La filosof√≠a es la reflexi√≥n y el pensamiento cr√≠tico que hace la inteligencia humana sobre s√≠ misma, sobre sus l√≠mites, sobre sus creaciones, sobre el ser humano y su relaci√≥n con la realidad.
        </p>
        <details class="mt-4 group">
          <summary class="cursor-pointer select-none list-none inline-flex items-center gap-2 text-cyan-300 hover:text-cyan-200">
            <span class="inline-block w-5" aria-hidden>‚û§</span>
            Ampliar explicaci√≥n
          </summary>
          <div class="mt-3 text-slate-300">
            <ul class="list-disc ml-5 space-y-2">
              <li><strong>Reflexi√≥n</strong>: pensar sobre lo que pensamos y hacemos.</li>
              <li><strong>Cr√≠tica</strong>: evaluar razones, supuestos y consecuencias.</li>
              <li><strong>Universalidad</strong>: busca respuestas v√°lidas para cualquiera.</li>
            </ul>
          </div>
        </details>
      </article>

      <!-- ¬øQu√© es una pregunta filos√≥fica? -->
      <article class="glass rounded-3xl p-6" aria-labelledby="tit-pf">
        <h3 id="tit-pf" class="text-2xl font-bold">¬øQu√© es una <em>pregunta filos√≥fica</em>?</h3>
        <p class="mt-3 text-slate-300">
          Nace de la <strong>curiosidad</strong> por nuestra relaci√≥n con el mundo, con los dem√°s y con nosotros mismos. No exige una respuesta definitiva: invita a la <strong>reflexi√≥n</strong>. Adem√°s, busca validez <strong>universal</strong>, no solo para un grupo.
        </p>
        <!-- Ejemplos -->
        <div class="mt-4">
          <h4 class="font-semibold">Ejemplos de preguntas filos√≥ficas</h4>
          <div class="mt-2 flex flex-wrap gap-2">
            <span class="px-3 py-1 rounded-full bg-cyan-400/15 text-cyan-200">¬øQu√© es la justicia?</span>
            <span class="px-3 py-1 rounded-full bg-cyan-400/15 text-cyan-200">¬øExiste el libre albedr√≠o?</span>
            <span class="px-3 py-1 rounded-full bg-cyan-400/15 text-cyan-200">¬øQu√© hace valiosa una vida?</span>
            <span class="px-3 py-1 rounded-full bg-cyan-400/15 text-cyan-200">¬øC√≥mo sabemos lo que sabemos?</span>
          </div>
          <h4 class="mt-4 font-semibold">No filos√≥ficas (informativas o t√©cnicas)</h4>
          <div class="mt-2 flex flex-wrap gap-2">
            <span class="px-3 py-1 rounded-full bg-white/10 text-slate-200">¬øCu√°l es la capital de Francia?</span>
            <span class="px-3 py-1 rounded-full bg-white/10 text-slate-200">¬øPor qu√© el cielo es azul?</span>
            <span class="px-3 py-1 rounded-full bg-white/10 text-slate-200">¬øCu√°nto mide el Everest?</span>
          </div>
        </div>
      </article>
    </div>
  </section>

  <!-- PRACTICAR: Clasificador -->
  <section id="practicar" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-10">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-2xl font-extrabold">Practicar ¬∑ ¬øFilos√≥fica o no?</h3>
      <div class="text-sm text-slate-400">Haz clic en cada tarjeta o usa teclas <span class="kbd">F</span>/<span class="kbd">N</span>.</div>
    </div>

    <div id="quiz" class="grid md:grid-cols-3 gap-4" aria-live="polite"></div>

    <div class="mt-4 flex flex-wrap gap-3">
      <button id="btnCorregir" class="px-4 py-2 rounded-xl bg-cyan-400 text-slate-900 font-semibold hover:bg-cyan-300 transition">Corregir</button>
      <button id="btnReiniciar" class="px-4 py-2 rounded-xl glass hover:ring-a transition">Reiniciar</button>
      <button id="btnMostrarSol" class="px-4 py-2 rounded-xl glass hover:ring-a transition">Mostrar soluciones</button>
    </div>

    <div id="panelExp" class="mt-6 glass rounded-2xl p-4 hidden" aria-live="polite"></div>
  </section>

  <!-- GENERAR: Creador de preguntas -->
  <section id="generar" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-10">
    <h3 class="text-2xl font-extrabold">Generador de preguntas filos√≥ficas</h3>
    <p class="mt-2 text-slate-300">Elige un tema y un enfoque para crear tu propia pregunta con alcance universal.</p>

    <div class="mt-4 grid md:grid-cols-3 gap-4 items-end">
      <label class="block">Tema
        <select id="selTema" class="mt-1 w-full rounded-xl bg-white/10 border border-white/10 p-2">
          <option>Yo y la identidad</option>
          <option>Mundo y realidad</option>
          <option>Conocimiento y verdad</option>
          <option>√âtica y moral</option>
          <option>Pol√≠tica y sociedad</option>
          <option>Arte y belleza</option>
          <option>Tecnolog√≠a y vida</option>
        </select>
      </label>
      <label class="block">Enfoque
        <select id="selMarco" class="mt-1 w-full rounded-xl bg-white/10 border border-white/10 p-2">
          <option>¬øQu√© es...?</option>
          <option>¬øPor qu√©...?</option>
          <option>¬øC√≥mo sabemos que...?</option>
          <option>¬øEs posible...?</option>
          <option>¬øDeber√≠amos...?</option>
        </select>
      </label>
      <label class="block">Universalidad
        <input id="rngUniv" type="range" min="0" max="100" value="70" class="mt-3 w-full">
      </label>
    </div>

    <div class="mt-4 flex gap-3">
      <button id="btnGenerar" class="px-4 py-2 rounded-xl bg-cyan-400 text-slate-900 font-semibold hover:bg-cyan-300 transition">Generar</button>
      <button id="btnGuardar" class="px-4 py-2 rounded-xl glass hover:ring-a transition" disabled>Guardar en mi cuaderno</button>
      <button id="btnExportar" class="px-4 py-2 rounded-xl glass hover:ring-a transition">Exportar .txt</button>
    </div>

    <div id="salidaGen" class="mt-4 glass rounded-2xl p-4 text-lg hidden" aria-live="polite"></div>

    <div class="mt-6">
      <h4 class="font-semibold">Mi cuaderno de preguntas</h4>
      <ul id="cuaderno" class="mt-2 space-y-2"></ul>
    </div>
  </section>

  <!-- DI√ÅLOGO: din√°mica r√°pida -->
  <section id="dialogo" class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 pb-14">
    <h3 class="text-2xl font-extrabold">Di√°logo socr√°tico ¬∑ Piensa ‚Äì Pareja ‚Äì Comparte</h3>
    <p class="mt-2 text-slate-300">Usa el temporizador para una din√°mica r√°pida en clase.</p>

    <div class="grid md:grid-cols-2 gap-6 mt-4">
      <div class="glass rounded-3xl p-6">
        <h4 class="font-semibold">Temporizador</h4>
        <div class="mt-3 flex items-center gap-3 flex-wrap">
          <label class="block">Piensa
            <input id="t1" type="number" class="mt-1 w-24 rounded-lg bg-white/10 border border-white/10 p-2" value="60" min="10" step="10"> s
          </label>
          <label class="block">Pareja
            <input id="t2" type="number" class="mt-1 w-24 rounded-lg bg-white/10 border border-white/10 p-2" value="120" min="20" step="10"> s
          </label>
          <label class="block">Comparte
            <input id="t3" type="number" class="mt-1 w-24 rounded-lg bg-white/10 border border-white/10 p-2" value="120" min="20" step="10"> s
          </label>
        </div>
        <div class="mt-4 text-5xl font-extrabold tabular-nums" id="visor">00:60</div>
        <div class="mt-4 flex gap-2">
          <button id="btnStart" class="px-4 py-2 rounded-xl bg-cyan-400 text-slate-900 font-semibold hover:bg-cyan-300 transition">Iniciar</button>
          <button id="btnPausa" class="px-4 py-2 rounded-xl glass hover:ring-a transition">Pausa</button>
          <button id="btnReset" class="px-4 py-2 rounded-xl glass hover:ring-a transition">Reset</button>
        </div>
        <p class="mt-3 text-sm text-slate-400">Consejo: cambia los tiempos seg√∫n la actividad.</p>
      </div>

      <div class="glass rounded-3xl p-6">
        <h4 class="font-semibold">Sugerencias para el di√°logo</h4>
        <ul class="mt-2 list-disc ml-5 space-y-2 text-slate-300">
          <li>Formula una <strong>tesis</strong> clara en 1 frase.</li>
          <li>Da <strong>razones</strong> y ejemplos relevantes.</li>
          <li>Escucha objeciones y a√±ade <strong>matices</strong>.</li>
          <li>Busca criterios con <strong>validez universal</strong>.</li>
        </ul>
        <div class="mt-4">
          <label class="block font-medium mb-2">Propuesta de arranque</label>
          <div class="flex gap-2">
            <button class="px-3 py-2 rounded-xl glass hover:ring-a transition" data-prompt>¬øQu√© hace valiosa una vida?</button>
            <button class="px-3 py-2 rounded-xl glass hover:ring-a transition" data-prompt>¬øPodemos ser libres sin responsabilidad?</button>
            <button class="px-3 py-2 rounded-xl glass hover:ring-a transition" data-prompt>¬øEs justo tratar igual a quienes son diferentes?</button>
          </div>
          <textarea id="cajaPrompt" class="mt-3 w-full rounded-xl bg-white/10 border border-white/10 p-3" rows="3" placeholder="Escribe o pega aqu√≠ la pregunta de partida"></textarea>
        </div>
      </div>
    </div>
  </section>

  <!-- MODALES -->
  <dialog id="modalAjustes" class="no-print glass rounded-2xl p-0 w-full max-w-xl text-slate-100">
    <form method="dialog">
      <div class="p-5 border-b border-white/10 flex items-center justify-between">
        <h3 class="text-lg font-bold">Ajustes de visualizaci√≥n</h3>
        <button class="px-2 py-1 glass rounded-lg">Cerrar</button>
      </div>
      <div class="p-5 space-y-4">
        <div class="flex items-center justify-between">
          <label for="fontUp">Tama√±o de texto</label>
          <input id="fontUp" type="range" min="14" max="22" value="16">
        </div>
        <div class="flex items-center justify-between">
          <label for="altoContraste">Alto contraste</label>
          <input id="altoContraste" type="checkbox">
        </div>
        <div class="flex items-center justify-between">
          <label for="modoLectura">Modo lectura (oculta extras)</label>
          <input id="modoLectura" type="checkbox">
        </div>
      </div>
      <div class="p-5 border-t border-white/10 text-sm text-slate-400">Tus preferencias se guardan en este dispositivo.</div>
    </form>
  </dialog>

  <dialog id="modalAyuda" class="no-print glass rounded-2xl p-0 w-full max-w-xl text-slate-100">
    <form method="dialog">
      <div class="p-5 border-b border-white/10 flex items-center justify-between">
        <h3 class="text-lg font-bold">Ayuda r√°pida</h3>
        <button class="px-2 py-1 glass rounded-lg">Cerrar</button>
      </div>
      <div class="p-5 space-y-3 text-slate-200">
        <p><strong>Leer</strong>: definici√≥n y ejemplos para introducir el tema.</p>
        <p><strong>Practicar</strong>: clasifica preguntas como filos√≥ficas o no.</p>
        <p><strong>Generar</strong>: crea y guarda tus propias preguntas.</p>
        <p><strong>Di√°logo</strong>: usa el temporizador y un prompt para conversar.</p>
        <p class="text-sm text-slate-400">Atajos: <span class="kbd">?</span> ayuda ¬∑ <span class="kbd">g</span> generar ¬∑ <span class="kbd">p</span> practicar.</p>
      </div>
    </form>
  </dialog>

  <!-- FOOTER -->
  <footer class="border-t border-white/10 py-6 text-center text-sm text-slate-400">
    Hecho con üß† y üí¨ para pensar mejor.
  </footer>

  <script>
  // ====== UTIL ======
  const $ = s => document.querySelector(s);
  const $$ = s => [...document.querySelectorAll(s)];
  const store = {
    get(k, def){ try{ return JSON.parse(localStorage.getItem(k)) ?? def }catch{ return def } },
    set(k, v){ localStorage.setItem(k, JSON.stringify(v)) }
  }

  // ====== QUIZ "Filos√≥fica o no" ======
  const items = [
    { t: '¬øQu√© es la justicia?', f: true, exp: 'Pregunta conceptual y normativa con validez universal.' },
    { t: '¬øCu√°l es la capital de Francia?', f: false, exp: 'Es informativa y se responde con datos.' },
    { t: '¬øExiste el libre albedr√≠o?', f: true, exp: 'Problema cl√°sico de metaf√≠sica y responsabilidad.' },
    { t: '¬øPor qu√© el cielo es azul?', f: false, exp: 'Explicaci√≥n cient√≠fica emp√≠rica, no filos√≥fica.' },
    { t: '¬øEs moral comer animales?', f: true, exp: 'Cuesti√≥n √©tica con pretensi√≥n de universalidad.' },
    { t: '¬øQu√© hace valiosa una vida?', f: true, exp: 'Explora criterios generales de valor.' },
    { t: '¬øCu√°nto mide el Everest?', f: false, exp: 'Dato mensurable, no una reflexi√≥n filos√≥fica.' },
    { t: '¬øC√≥mo sabemos lo que sabemos?', f: true, exp: 'Pregunta epistemol√≥gica sobre el conocimiento.' },
  ];

  const quizEl = $('#quiz');
  const panelExp = $('#panelExp');
  let respuestas = Array(items.length).fill(null);

  function renderQuiz(){
    quizEl.innerHTML = items.map((it,i)=>{
      return `<article class="glass rounded-2xl p-4 min-h-[140px] flex flex-col justify-between" data-i="${i}">
        <div class="text-slate-100 text-lg">${it.t}</div>
        <div class="mt-4 flex gap-2" role="group" aria-label="Clasificar">
          <button class="btn-f px-3 py-1.5 rounded-lg bg-cyan-400/20 hover:bg-cyan-400/30" aria-pressed="false">Filos√≥fica</button>
          <button class="btn-n px-3 py-1.5 rounded-lg bg-white/10 hover:bg-white/20" aria-pressed="false">No filos√≥fica</button>
        </div>
        <div class="mt-2 text-sm text-slate-300 hidden exp"></div>
      </article>`
    }).join('');

    // Attach events
    $$('#quiz .btn-f').forEach(btn=>btn.addEventListener('click', e=>toggle(e, true)));
    $$('#quiz .btn-n').forEach(btn=>btn.addEventListener('click', e=>toggle(e, false)));
    // Keyboard shortcuts F/N for focused card
    quizEl.addEventListener('keydown', e=>{
      const card = e.target.closest('article');
      if(!card) return;
      const i = +card.dataset.i;
      if(e.key.toLowerCase()==='f'){ setChoice(i,true,card); }
      if(e.key.toLowerCase()==='n'){ setChoice(i,false,card); }
    });
    // Make each card focusable for a11y
    $$('#quiz article').forEach(a=>a.tabIndex=0);
  }

  function toggle(e, val){
    const card = e.target.closest('article');
    const i = +card.dataset.i;
    setChoice(i, val, card);
  }

  function setChoice(i, val, card){
    respuestas[i] = val;
    const bF = card.querySelector('.btn-f');
    const bN = card.querySelector('.btn-n');
    bF.setAttribute('aria-pressed', val);
    bN.setAttribute('aria-pressed', !val);
    bF.classList.toggle('bg-cyan-400', val);
    bF.classList.toggle('text-slate-900', val);
    bF.classList.toggle('bg-cyan-400/20', !val);
    bN.classList.toggle('bg-cyan-400', !val);
    bN.classList.toggle('text-slate-900', !val);
    bN.classList.toggle('bg-white/10', val);
  }

  function corregir(mostrarExp){
    let aciertos = 0;
    $$('#quiz article').forEach((card, i)=>{
      const ok = items[i].f;
      const val = respuestas[i];
      const exp = card.querySelector('.exp');
      exp.textContent = (val===ok? '‚úîÔ∏è Bien: ':'‚ùå Ojo: ') + items[i].exp;
      exp.classList.toggle('hidden', !mostrarExp);
      card.classList.remove('ring-4','ring-red-400','ring-green-400');
      if(val===ok){ aciertos++; card.classList.add('ring-4','ring-green-400') }
      else { card.classList.add('ring-4','ring-red-400') }
    });
    panelExp.classList.remove('hidden');
    panelExp.innerHTML = `<div class="text-lg font-semibold">Resultado: ${aciertos}/${items.length}</div>
      <div class="text-sm text-slate-300 mt-1">Recuerda: una pregunta filos√≥fica apunta a conceptos, razones y criterios generales (universalidad), no solo a datos.</div>`;
  }

  $('#btnCorregir').addEventListener('click', ()=>corregir(true));
  $('#btnReiniciar').addEventListener('click', ()=>{ respuestas = Array(items.length).fill(null); renderQuiz(); panelExp.classList.add('hidden') });
  $('#btnMostrarSol').addEventListener('click', ()=>{
    respuestas = items.map(it=>it.f);
    renderQuiz();
    corregir(true);
  });

  renderQuiz();

  // ====== GENERADOR ======
  const plantillas = {
    '¬øQu√© es...?': [
      '¬øQu√© es realmente la identidad personal?',
      '¬øQu√© es la justicia y c√≥mo se aplica en situaciones l√≠mite?',
      '¬øQu√© es la belleza en la era digital?',
      '¬øQu√© es la verdad cuando las fuentes se contradicen?'
    ],
    '¬øPor qu√©...?': [
      '¬øPor qu√© deber√≠amos preocuparnos por las generaciones futuras?',
      '¬øPor qu√© confiamos en los sentidos si a veces nos enga√±an?',
      '¬øPor qu√© valoramos m√°s la libertad que la seguridad (o al rev√©s)?'
    ],
    '¬øC√≥mo sabemos que...?': [
      '¬øC√≥mo sabemos que no estamos sesgados al juzgar?',
      '¬øC√≥mo sabemos que algo es justo para todos y no solo para algunos?',
      '¬øC√≥mo sabemos que existe un mundo externo independiente de la mente?'
    ],
    '¬øEs posible...?': [
      '¬øEs posible vivir una vida buena sin dolor?',
      '¬øEs posible el conocimiento objetivo?',
      '¬øEs posible una tecnolog√≠a √©ticamente neutral?'
    ],
    '¬øDeber√≠amos...?': [
      '¬øDeber√≠amos sacrificar libertad por seguridad?',
      '¬øDeber√≠amos dar el mismo valor moral a todos los seres sintientes?',
      '¬øDeber√≠amos fiarnos de la mayor√≠a para decidir qu√© es justo?'
    ]
  };

  const selTema = $('#selTema');
  const selMarco = $('#selMarco');
  const rngUniv = $('#rngUniv');
  const salidaGen = $('#salidaGen');
  const btnGuardar = $('#btnGuardar');
  const cuaderno = $('#cuaderno');

  function generar(){
    const tema = selTema.value;
    const marco = selMarco.value;
    const base = plantillas[marco][Math.floor(Math.random()*plantillas[marco].length)];
    const univ = +rngUniv.value;
    const nota = univ>=70 ? 'con alcance universal (busca criterios v√°lidos para cualquiera)' : univ>=40 ? 'intentando generalizar m√°s all√° de casos particulares' : 'ojo: quiz√° es demasiado particular, trata de universalizarla';
    const texto = `${marco.replace('...','')} ${base.replace(/^¬ø|\?$/g,'')} (${tema})`;
    salidaGen.textContent = texto + ' ‚Äî ' + nota + '.';
    salidaGen.classList.remove('hidden');
    btnGuardar.disabled = false;
    return texto;
  }

  function pintarCuaderno(){
    const lista = store.get('cuadernoFilo', []);
    cuaderno.innerHTML = lista.map((q,i)=>
      `<li class="glass rounded-xl p-3 flex items-center justify-between gap-3">
        <span>${q}</span>
        <div class="flex gap-2">
          <button data-up="${i}" class="px-2 py-1 glass rounded-lg" title="Subir">‚Üë</button>
          <button data-down="${i}" class="px-2 py-1 glass rounded-lg" title="Bajar">‚Üì</button>
          <button data-del="${i}" class="px-2 py-1 bg-red-500/20 hover:bg-red-500/30 rounded-lg" title="Eliminar">Eliminar</button>
        </div>
      </li>`
    ).join('');
  }

  $('#btnGenerar').addEventListener('click', generar);

  btnGuardar.addEventListener('click', ()=>{
    const lista = store.get('cuadernoFilo', []);
    const q = salidaGen.textContent.split(' ‚Äî ')[0];
    if(q && !lista.includes(q)){
      lista.push(q);
      store.set('cuadernoFilo', lista);
      pintarCuaderno();
      btnGuardar.disabled = true;
    }
  });

  $('#btnExportar').addEventListener('click', ()=>{
    const lista = store.get('cuadernoFilo', []);
    const blob = new Blob([lista.join('\n')||'(cuaderno vac√≠o)'], {type:'text/plain'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'cuaderno_filosofia.txt';
    a.click(); URL.revokeObjectURL(a.href);
  });

  cuaderno.addEventListener('click', e=>{
    const lista = store.get('cuadernoFilo', []);
    if(e.target.dataset.del){ lista.splice(+e.target.dataset.del,1) }
    if(e.target.dataset.up){ const i=+e.target.dataset.up; if(i>0){ [lista[i-1],lista[i]]=[lista[i],lista[i-1]] } }
    if(e.target.dataset.down){ const i=+e.target.dataset.down; if(i<lista.length-1){ [lista[i+1],lista[i]]=[lista[i],lista[i+1]] } }
    store.set('cuadernoFilo', lista); pintarCuaderno();
  });

  pintarCuaderno();

  // ====== DI√ÅLOGO: Temporizador ======
  let fase = 0; // 0 piensa, 1 pareja, 2 comparte
  let restante = 0;
  let intv = null;
  const visor = $('#visor');
  function secActual(){ return [$('#t1').value, $('#t2').value, $('#t3').value].map(n=>parseInt(n,10)) }
  function etiquetar(i){ return ['Piensa','Pareja','Comparte'][i] }
  function format(s){ return String(s).padStart(2,'0') }
  function tick(){
    if(restante<=0){ fase++; const sec = secActual(); if(fase>2){ stop(); return } restante = sec[fase]; announce(`Fase: ${etiquetar(fase)}`) }
    visor.textContent = `${format(Math.floor(restante/60))}:${format(restante%60)}`;
    restante--;
  }
  function start(){ if(intv) return; fase=0; restante=secActual()[0]; announce('Fase: Piensa'); intv = setInterval(tick,1000); }
  function pause(){ if(!intv) return; clearInterval(intv); intv=null }
  function stop(){ pause(); visor.textContent = '00:60' }
  function announce(msg){ const el = document.createElement('div'); el.className='sr-only'; el.textContent=msg; document.body.appendChild(el); setTimeout(()=>el.remove(),500) }

  $('#btnStart').addEventListener('click', start);
  $('#btnPausa').addEventListener('click', pause);
  $('#btnReset').addEventListener('click', stop);

  // ====== PROMPTS R√ÅPIDOS ======
  $$('[data-prompt]').forEach(b=>b.addEventListener('click', ()=>{ $('#cajaPrompt').value = b.textContent }))

  // ====== MODALES + AJUSTES ======
  const modalAjustes = $('#modalAjustes');
  const modalAyuda = $('#modalAyuda');
  $('#btnAjustes').addEventListener('click', ()=>modalAjustes.showModal());
  $('#btnAyuda').addEventListener('click', ()=>modalAyuda.showModal());

  // Preferencias visuales
  const pref = store.get('ui.pref', { fs:16, contrast:false, lectura:false });
  document.documentElement.style.fontSize = pref.fs+'px';
  if(pref.contrast){ document.body.classList.add('contrast') }
  if(pref.lectura){ document.body.classList.add('lectura') }

  $('#fontUp').value = pref.fs;
  $('#altoContraste').checked = pref.contrast;
  $('#modoLectura').checked = pref.lectura;

  $('#fontUp').addEventListener('input', e=>{ document.documentElement.style.fontSize = e.target.value+'px'; pref.fs=+e.target.value; store.set('ui.pref',pref) })
  $('#altoContraste').addEventListener('change', e=>{ document.body.classList.toggle('contrast', e.target.checked); pref.contrast=e.target.checked; store.set('ui.pref',pref) })
  $('#modoLectura').addEventListener('change', e=>{ document.body.classList.toggle('lectura', e.target.checked); pref.lectura=e.target.checked; store.set('ui.pref',pref) })

  // Estilos alternativos seg√∫n preferencias
  const style = document.createElement('style');
  style.textContent = `
    body.contrast { color:#111; background:#fff; }
    body.contrast .glass{ background:#fff; border-color:#1113 }
    body.lectura header, body.lectura #practicar ~ *, body.lectura #generar ~ *, body.lectura #dialogo ~ * { display:block }
    body.lectura .no-print, body.lectura [data-prompt] { display:none !important }
  `;
  document.head.appendChild(style);

  // ====== ATAJOS ======
  window.addEventListener('keydown', e=>{
    if(e.key === '?'){ modalAyuda.open? modalAyuda.close():modalAyuda.showModal() }
    if(e.key.toLowerCase()==='g'){ location.hash = '#generar' }
    if(e.key.toLowerCase()==='p'){ location.hash = '#practicar' }
  });
  </script>
</body>
</html>
